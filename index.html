<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>منصة الروايات</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Tajawal', sans-serif;
        }

        body {
            background-color: #23252b;
            color: #ffffff;
            overflow-x: hidden;
        }

        .container {
            max-width: 100%;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 20px 0;
            background-color: #191b1f;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        h1 {
            color: #f47521;
            margin-bottom: 10px;
        }

        .subheading {
            color: #9fadbd;
            font-size: 1.2rem;
        }

        .arcs-container {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        .arc {
            background-color: #191b1f;
            border-radius: 10px;
            padding: 20px;
        }

        .arc-title {
            color: #f47521;
            font-size: 1.5rem;
            margin-bottom: 15px;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .arc-title::after {
            content: '';
            display: block;
            height: 2px;
            background-color: #f47521;
            width: 50px;
            margin-top: 5px;
        }

        .chapters-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }

        .chapter-card {
            background-color: #23252b;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
            transition: transform 0.3s ease;
            height: 300px;
        }

        .chapter-card:hover {
            transform: translateY(-5px);
        }

        .chapter-preview {
            position: relative;
            height: 250px;
            overflow: hidden;
        }

        .chapter-images {
            display: flex;
            width: 1600%;
            transition: transform 0.5s ease;
        }

        .chapter-image {
            width: 6.25%;  /* 100/16 */
            height: 250px;
            background-color: #191b1f;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #9fadbd;
        }

        .chapter-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .nav-buttons {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 10px;
        }

        .nav-button {
            background-color: rgba(35, 37, 43, 0.7);
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 18px;
            transition: background-color 0.3s;
            z-index: 2;
        }

        .nav-button:hover {
            background-color: rgba(244, 117, 33, 0.7);
        }

        .chapter-info {
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chapter-title {
            font-size: 1rem;
            color: #ffffff;
        }

        .chapter-number {
            color: #9fadbd;
            font-size: 0.8rem;
        }

        .actions {
            display: flex;
            gap: 10px;
        }

        .save-button, .share-button {
            background: none;
            border: none;
            color: #9fadbd;
            cursor: pointer;
            font-size: 1.2rem;
            transition: color 0.3s;
        }

        .save-button:hover, .share-button:hover {
            color: #f47521;
        }

        .saved {
            color: #f47521;
        }

        .novel-info-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(25, 27, 31, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10;
        }

        .modal-content {
            background-color: #23252b;
            border-radius: 10px;
            width: 90%;
            max-width: 600px;
            padding: 20px;
            position: relative;
        }

        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            color: #ffffff;
            font-size: 1.5rem;
            cursor: pointer;
        }

        .novel-details {
            margin-top: 20px;
        }

        .novel-title {
            color: #f47521;
            font-size: 1.8rem;
            margin-bottom: 10px;
        }

        .novel-author {
            color: #ffffff;
            font-size: 1.2rem;
            margin-bottom: 15px;
        }

        .novel-description {
            color: #9fadbd;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .novel-meta {
            display: flex;
            gap: 20px;
            margin-top: 20px;
            border-top: 1px solid #9fadbd;
            padding-top: 15px;
        }

        .meta-item {
            display: flex;
            flex-direction: column;
        }

        .meta-label {
            font-size: 0.8rem;
            color: #9fadbd;
        }

        .meta-value {
            color: #ffffff;
        }

        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #191b1f;
            color: #ffffff;
            padding: 15px 20px;
            border-radius: 5px;
            border-right: 4px solid #f47521;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .toast.show {
            opacity: 1;
            transform: translateY(0);
        }

        .page-indicator {
            color: #9fadbd;
            font-size: 0.8rem;
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
        }

        @media (max-width: 768px) {
            .chapters-list {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            }
            .chapter-card {
                height: 280px;
            }
            .chapter-preview {
                height: 220px;
            }
        }

        @media (max-width: 480px) {
            .chapters-list {
                grid-template-columns: 1fr;
            }
            .container {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>منصة الروايات العربية</h1>
            <p class="subheading">استكشف أفضل الروايات بين أركات وفصول متنوعة</p>
        </header>

        <div class="arcs-container" id="arcs-container">
            <!-- سيتم إضافة الأركات ديناميكياً هنا -->
        </div>
    </div>

    <!-- نافذة معلومات الرواية -->
    <div class="novel-info-modal" id="novelInfoModal">
        <div class="modal-content">
            <button class="close-modal" id="closeModal">×</button>
            <div class="novel-details" id="novelDetails">
                <!-- سيتم إضافة تفاصيل الرواية هنا -->
            </div>
        </div>
    </div>

    <!-- رسالة توست -->
    <div class="toast" id="toast"></div>

    <script>
        // بيانات الأركات والفصول (يمكن استبدالها ببيانات حقيقية من الخادم)
        const arcsData = [
            {
                id: 1,
                title: "الأرك الأول: البداية",
                chapters: [
                    { id: 1, title: "مقدمة الحكاية", number: "الفصل 1" },
                    { id: 2, title: "الشخصيات الرئيسية", number: "الفصل 2" },
                    { id: 3, title: "بداية المغامرة", number: "الفصل 3" },
                    { id: 4, title: "اكتشاف الحقيقة", number: "الفصل 4" }
                ]
            },
            {
                id: 2,
                title: "الأرك الثاني: المواجهة",
                chapters: [
                    { id: 5, title: "صراع القوى", number: "الفصل 5" },
                    { id: 6, title: "التحدي الكبير", number: "الفصل 6" },
                    { id: 7, title: "المعركة الحاسمة", number: "الفصل 7" },
                    { id: 8, title: "نتائج المواجهة", number: "الفصل 8" }
                ]
            },
            {
                id: 3,
                title: "الأرك الثالث: النهاية",
                chapters: [
                    { id: 9, title: "تجمع الأبطال", number: "الفصل 9" },
                    { id: 10, title: "المعركة الأخيرة", number: "الفصل 10" },
                    { id: 11, title: "النصر والخسارة", number: "الفصل 11" },
                    { id: 12, title: "النهاية والبداية", number: "الفصل 12" }
                ]
            }
        ];

        // معلومات الرواية (لكل فصل)
        const chaptersInfo = {
            1: {
                title: "مقدمة الحكاية",
                author: "أحمد محمود",
                description: "في هذا الفصل، نبدأ رحلتنا مع البطل الرئيسي الذي يكتشف قدراته الخاصة في عالم مليء بالغموض والتحديات. يصف الفصل بداية استكشاف البطل لهويته الحقيقية والمصير المنتظر له.",
                genre: "خيال علمي",
                publishDate: "10 يناير 2025",
                rating: "4.8/5"
            },
            // يمكن إضافة معلومات لبقية الفصول هنا
        };

        // المحفوظات
        let savedChapters = JSON.parse(localStorage.getItem('savedChapters')) || [];

        // إنشاء هيكل الصفحة
        function renderArcs() {
            const arcsContainer = document.getElementById('arcs-container');
            arcsContainer.innerHTML = '';

            arcsData.forEach(arc => {
                const arcElement = document.createElement('div');
                arcElement.className = 'arc';
                arcElement.innerHTML = `
                    <div class="arc-title">
                        <span>${arc.title}</span>
                    </div>
                    <div class="chapters-list" id="arc-${arc.id}-chapters"></div>
                `;
                arcsContainer.appendChild(arcElement);

                const chaptersContainer = document.getElementById(`arc-${arc.id}-chapters`);
                arc.chapters.forEach(chapter => {
                    const chapterElement = document.createElement('div');
                    chapterElement.className = 'chapter-card';
                    chapterElement.innerHTML = `
                        <div class="chapter-preview">
                            <div class="chapter-images" id="chapter-${chapter.id}-images">
                                ${generateImages(chapter.id)}
                            </div>
                            <div class="nav-buttons">
                                <button class="nav-button prev" onclick="navigateChapter(${chapter.id}, 'prev')">‹</button>
                                <button class="nav-button next" onclick="navigateChapter(${chapter.id}, 'next')">›</button>
                            </div>
                            <div class="page-indicator" id="page-indicator-${chapter.id}">1 / 16</div>
                        </div>
                        <div class="chapter-info">
                            <div>
                                <div class="chapter-title">${chapter.title}</div>
                                <div class="chapter-number">${chapter.number}</div>
                            </div>
                            <div class="actions">
                                <button class="save-button ${savedChapters.includes(chapter.id) ? 'saved' : ''}" id="save-${chapter.id}" onclick="toggleSave(${chapter.id})">
                                    ${savedChapters.includes(chapter.id) ? '★' : '☆'}
                                </button>
                            </div>
                        </div>
                    `;
                    chaptersContainer.appendChild(chapterElement);

                    // إضافة مستمعي الأحداث
                    chapterElement.addEventListener('dblclick', () => shareChapter(chapter.id));
                    chapterElement.addEventListener('touchstart', handleTouchStart);
                    chapterElement.addEventListener('touchend', (e) => handleTouchEnd(e, chapter.id));
                });
            });
        }

        // إنشاء الصور للفصل
        function generateImages(chapterId) {
            let imagesHTML = '';
            for (let i = 1; i <= 16; i++) {
                imagesHTML += `
                    <div class="chapter-image">
                        <div>صورة ${i} للفصل ${chapterId}</div>
                    </div>
                `;
            }
            return imagesHTML;
        }

        // متغيرات للتعامل مع النقر المطول
        let touchStartTime = 0;
        let touchTimer;

        // معالجة بداية اللمس
        function handleTouchStart(e) {
            touchStartTime = new Date().getTime();
            touchTimer = setTimeout(() => {
                const chapterId = parseInt(e.currentTarget.querySelector('.save-button').id.split('-')[1]);
                showNovelInfo(chapterId);
            }, 800); // 800 مللي ثانية للنقر المطول
        }

        // معالجة نهاية اللمس
        function handleTouchEnd(e, chapterId) {
            const touchEndTime = new Date().getTime();
            clearTimeout(touchTimer);
            
            // إذا كان النقر سريعاً، لا نعتبره نقراً مطولاً
            if (touchEndTime - touchStartTime < 800) {
                return;
            }
        }

        // التنقل بين صور الفصل
        let currentPages = {};

        function navigateChapter(chapterId, direction) {
            if (!currentPages[chapterId]) {
                currentPages[chapterId] = 1;
            }

            const imagesContainer = document.getElementById(`chapter-${chapterId}-images`);
            const pageIndicator = document.getElementById(`page-indicator-${chapterId}`);
            
            if (direction === 'next' && currentPages[chapterId] < 16) {
                currentPages[chapterId]++;
            } else if (direction === 'prev' && currentPages[chapterId] > 1) {
                currentPages[chapterId]--;
            }

            const translateValue = (currentPages[chapterId] - 1) * -6.25;
            imagesContainer.style.transform = `translateX(${translateValue}%)`;
            pageIndicator.textContent = `${currentPages[chapterId]} / 16`;
        }

        // تبديل حالة الحفظ
        function toggleSave(chapterId) {
            const saveButton = document.getElementById(`save-${chapterId}`);
            
            if (savedChapters.includes(chapterId)) {
                // إزالة من المحفوظات
                savedChapters = savedChapters.filter(id => id !== chapterId);
                saveButton.innerHTML = '☆';
                saveButton.classList.remove('saved');
                showToast('تم إزالة الفصل من المحفوظات');
            } else {
                // إضافة إلى المحفوظات
                savedChapters.push(chapterId);
                saveButton.innerHTML = '★';
                saveButton.classList.add('saved');
                showToast('تم حفظ الفصل في المحفوظات');
            }
            
            // حفظ في التخزين المحلي
            localStorage.setItem('savedChapters', JSON.stringify(savedChapters));
        }

        // مشاركة الفصل
        function shareChapter(chapterId) {
            if (navigator.share) {
                navigator.share({
                    title: `الفصل ${chapterId} من الرواية`,
                    text: `أشارك معك الفصل ${chapterId} من الرواية - استمتع بالقراءة!`,
                    url: window.location.href + `?chapter=${chapterId}`
                })
                .then(() => showToast('تمت المشاركة بنجاح'))
                .catch(() => showToast('حدث خطأ أثناء المشاركة'));
            } else {
                showToast('المشاركة غير مدعومة في متصفحك');
            }
        }

        // عرض معلومات الرواية
        function showNovelInfo(chapterId) {
            const modal = document.getElementById('novelInfoModal');
            const detailsContainer = document.getElementById('novelDetails');
            
            const chapterInfo = chaptersInfo[chapterId] || {
                title: `الفصل ${chapterId}`,
                author: "الكاتب المجهول",
                description: "لا يوجد وصف متاح لهذا الفصل.",
                genre: "غير محدد",
                publishDate: "غير محدد",
                rating: "غير متاح"
            };
            
            detailsContainer.innerHTML = `
                <h2 class="novel-title">${chapterInfo.title}</h2>
                <div class="novel-author">تأليف: ${chapterInfo.author}</div>
                <p class="novel-description">${chapterInfo.description}</p>
                <div class="novel-meta">
                    <div class="meta-item">
                        <span class="meta-label">التصنيف</span>
                        <span class="meta-value">${chapterInfo.genre}</span>
                    </div>
                    <div class="meta-item">
                        <span class="meta-label">تاريخ النشر</span>
                        <span class="meta-value">${chapterInfo.publishDate}</span>
                    </div>
                    <div class="meta-item">
                        <span class="meta-label">التقييم</span>
                        <span class="meta-value">${chapterInfo.rating}</span>
                    </div>
                </div>
            `;
            
            modal.style.display = 'flex';
        }

        // إغلاق النافذة المنبثقة
        document.getElementById('closeModal').addEventListener('click', () => {
            document.getElementById('novelInfoModal').style.display = 'none';
        });

        // عرض رسالة توست
        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // تهيئة التطبيق
        document.addEventListener('DOMContentLoaded', () => {
            renderArcs();
        });
    </script>
</body>
</html>
